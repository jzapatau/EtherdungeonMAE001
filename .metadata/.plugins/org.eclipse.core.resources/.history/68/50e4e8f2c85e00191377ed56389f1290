// --------------------------------------------------------
// Code generated by Papyrus Java
// --------------------------------------------------------

package MAE1Project;

//------------------ IMPORT MODULES ---------------------------//

import java.util.ArrayList;

/************************************************************/
/**
 * @author Felix Zapata
 * Date: 3/04/2019
 * 
 * Game class is the commanding class of the entire program. It
 * controls the flow of the program since its beginning until it's
 * end.
 */
public class Game {
	
	// ------------------------------ PROPERTIES -----------------------------//
	
	/**
	 * ui class is used to interface with the ui of the program
	 */
	private UI ui;
	/**
	 * encounter is an array of class Encounter to keep a log of the
	 * encounters taken.
	 */
	private ArrayList<Encounter> encounters;
	/**
	 * settings define the different settings of game which are later used to start the game
	 */
	private Settings settings;
	
	// ------------------------------ METHODS -------------------------------//

	/**
	 * Class constructor
	 */
	public Game() {
		// Define the properties
		ui = UI.INSTANCE;
		encounters = new ArrayList<Encounter>();
		
		// Present the game
		presentGame();
		
		// Ask for settings
		settings = new Settings();
		
		
	}
	
	/**
	 * presentGame is a private method which presents the game to the user with an
	 * introductory message that's appealing to it.
	 */
	private void presentGame() {
		// Present the GAME to the user
		String out = "\n --------------------------- WELCOME!!!!!!!-------------------------\n";
		out += "\n..this is Mists of Etherdungeon.. are you ready to play you filthy mortal?.....\n";
		out += "Episode IV, A NEW HOPE It is a period of civil war. \n"
				+ "Rebel spaceships, striking from a hidden base, \n"
				+ "have won their first victory against the evil Galactic Empire. During the battle, \n"
				+ "Rebel spies managed to steal secret plans to the Empire’s ultimate weapon, the DEATH STAR,\n"
				+ " an armored space station with enough power to destroy an entire planet.\n"
				+ " Pursued by the Empire’s sinister agents, Princess Leia races home aboard her starship,\n"
				+ " custodian of the stolen plans that can save her people and restore freedom to the galaxy….";
		
		out += "\n\n ... now enough bullshit ... time to light up this game!!!";
		
		// Print to screen
		ui.printToScreen(out);
	}
	
	/**
	 * endGame method is a private method which outputs the ending message of the game
	 */
	private void endGame() {
		// Close the GAME to the user
		String out = "\n ---------------------- GAME HAS FINISHED!!!!! ------------------------ \n";
		out += "Thank you for playing !!!!";
		
		// Print the message to the screen
		ui.printToScreen(out);
	}
	
	/**
	 * runGame is the method which executes the game per se and starts it.
	 */
	public void runGame() {
		// Print the start up
		String out = "\n ...OK, WE ARE ALL SET GUYS, LET'S START!!!!!!!! .......\n";
		ui.printToScreen(out);
		
		// Run the encounters
		for (int i = 0; i < settings.getPlayerMode().getMaxEncounters(); i++) {
			Encounter newEncounter = settings.getPlayerMode().generateNewEncounter(settings);
			newEncounter.runEncounter();
			
			// Check for the encounter was won, in such a case account for it 
			if (newEncounter.isWon())
			{
				// Recondition after encounter according to the player mode
				settings.getPlayerMode().reconditionAfterEncounter(settings, newEncounter);
			}
			else {
				// If the encounter was not won then break the loop
				break;
			}
		}
		
		// Close the game
		endGame();
	}
	
	// -------------------------- GETTERS AND SETTERS -----------------------//

	public UI getUi() {
		return ui;
	}

	public void setUi(UI ui) {
		this.ui = ui;
	}

	public ArrayList<Encounter> getEncounters() {
		return encounters;
	}

	public void setEncounters(ArrayList<Encounter> encounters) {
		this.encounters = encounters;
	}

	public Settings getSettings() {
		return settings;
	}

	public void setSettings(Settings settings) {
		this.settings = settings;
	}
	

};
